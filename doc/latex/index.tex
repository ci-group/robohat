\chapter{Main page}
\hypertarget{index}{}\label{index}\index{Main page@{Main page}}
\doxysection*{\doxylink{namespace_robohat}{Robohat} library}

Version\+: 0.\+0.\+2

A little example of using the \doxylink{namespace_robohat}{Robohat} library


\begin{DoxyCode}{0}
\DoxyCodeLine{robohat\ =\ \mbox{\hyperlink{namespace_robohat}{Robohat}}(main\_config.servoassembly\_1\_config,\ main\_config.servoassembly\_2\_config,\ main\_config.TOPBOARD\_IOEXANDER\_SW)}
\DoxyCodeLine{robohat.scan\_i2c\_bus()}
\DoxyCodeLine{robohat.init(main\_config.SERVOBOARD\_1\_DATAS\_ARRAY,\ main\_config.SERVOBOARD\_2\_DATAS\_ARRAY)}
\DoxyCodeLine{}
\DoxyCodeLine{robohat.set\_led\_color(Color.GREEN)}
\DoxyCodeLine{}
\DoxyCodeLine{for\ i\ in\ range(1,1800,\ 1):}
\DoxyCodeLine{\ \ \ \ angle\ =\ i\ /\ 10.0}
\DoxyCodeLine{\ \ \ \ robohat.set\_servos\_angles([angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle])}
\DoxyCodeLine{\ \ \ \ print("{}-\/-\/>"{}\ +\ str(robohat.get\_servo\_angle(1))\ +\ "{}\ °"{})}
\DoxyCodeLine{\ \ \ \ time.sleep(1)}
\DoxyCodeLine{}
\DoxyCodeLine{robohat.set\_led\_color(Color.RED)}
\DoxyCodeLine{for\ i\ in\ range(1800,1,\ -\/1):}
\DoxyCodeLine{\ \ \ \ angle\ =\ i\ /\ 10.0}
\DoxyCodeLine{\ \ \ \ robohat.set\_servos\_angles([angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle,\ angle])}
\DoxyCodeLine{\ \ \ \ print("{}-\/-\/>"{}\ +\ str(robohat.get\_servo\_angle(1))\ +\ "{}\ °"{})}
\DoxyCodeLine{\ \ \ \ time.sleep(1)}

\end{DoxyCode}
 {\itshape example sourcecode}

~\newline
 The Startpoint of the Robo\+Hat Library is the \doxylink{namespace_robohat}{Robohat} class ~\newline


\doxysection*{\doxylink{namespace_robohat}{Robohat} constructor}

~\newline
 The \doxylink{namespace_robohat}{Robohat} constructor, consist out of 3 parameters, 2 Servo\+Assembly\+Configs and a Switch value ~\newline



\begin{DoxyCode}{0}
\DoxyCodeLine{robohat\ =\ \mbox{\hyperlink{namespace_robohat}{Robohat}}(SERVOASSEMBLY\_1\_CONFIG,\ SERVOASSEMBLY\_2\_CONFIG,\ TOPBOARD\_IO\_SWITCH)}

\end{DoxyCode}
 {\itshape \doxylink{namespace_robohat}{Robohat} constructor}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+CONFIG }&\cellcolor{\tableheadbgcolor}\textbf{ configuration of first servo assembly (Servo\+Assembly\+Config)   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+CONFIG }&\cellcolor{\tableheadbgcolor}\textbf{ configuration of first servo assembly (Servo\+Assembly\+Config)   }\\\cline{1-2}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+2\+\_\+\+CONFIG }&\cellcolor{\tableheadbgcolor}\textbf{ configuration of second servo assembly (Servo\+Assembly\+Config)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ TOPBOARD\+\_\+\+IO\+\_\+\+SWITCH }&\cellcolor{\tableheadbgcolor}\textbf{ IO Expander switch value (int)   }\\\cline{1-2}
\end{longtabu}


~\newline
 The servo assembly is the PCB to which the servos are connected 

\doxysection*{Servo\+Assembly\+Config}

A Servo\+Assembly\+Config consist out of 4 parameters.


\begin{DoxyCode}{0}
\DoxyCodeLine{servoassembly\_1\_config\ =\ ServoAssemblyConfig(SERVOASSEMBLY\_1\_NAME,\ SERVOASSEMBLY\_1\_SW1\_PWM\_ADDRESS,SERVOASSEMBLY\_1\_SW2\_POWER\_GOOD\_ADDRESS,\ SERVOASSEMBLY\_1\_PWMPLUG)}

\end{DoxyCode}
 {\itshape Servo\+Assembly\+Config constructor}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+NAME }&\cellcolor{\tableheadbgcolor}\textbf{ for your own reference   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+NAME }&\cellcolor{\tableheadbgcolor}\textbf{ for your own reference   }\\\cline{1-2}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+SW1\+\_\+\+PWM\+\_\+\+ADDRESS }&\cellcolor{\tableheadbgcolor}\textbf{ SW1, switch value for the PWM address (default 0 or 1)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+SW2\+\_\+\+POWER\+\_\+\+GOOD\+\_\+\+ADDRESS }&\cellcolor{\tableheadbgcolor}\textbf{ SW2, switch value for the POWER GOOD address (default 0 or 1, but the same as SW1)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ SERVOASSEMBLY\+\_\+1\+\_\+\+PWMPLUG }&\cellcolor{\tableheadbgcolor}\textbf{ cable connected to P3 or P4 of the topboard  }\\\cline{1-2}
\end{longtabu}




~\newline


\doxysection*{IO Expander switch value}

The last parameter of the robohat constructor, is the \textquotesingle{}topboard\+\_\+io\+\_\+switch\textquotesingle{} value. Default its value 7.~\newline
 This value determines the The I2\+C-\/address of the IOexpander (MCP23008) of the topboard.~\newline
 The IO-\/pins can be accessed by plug J2 of the topboard~\newline


 

~\newline


\doxysection*{I2\+C-\/scan}

After the constructor, an I2\+C-\/scan can be done by issuing \+: ~\newline



\begin{DoxyCode}{0}
\DoxyCodeLine{robohat.scan\_i2c\_bus()}

\end{DoxyCode}
 {\itshape Scanning for i2c-\/devices}

~\newline
 This is not mandatory, but easy for debugging ~\newline


\doxysection*{robohat.\+init}

Before we have some action, we have to initialize the robohat class~\newline
 This will also give the parameters to each servo.~\newline
 ~\newline



\begin{DoxyCode}{0}
\DoxyCodeLine{robohat.init(main\_config.SERVOBOARD\_1\_DATAS\_ARRAY,\ main\_config.SERVOBOARD\_2\_DATAS\_ARRAY)}

\end{DoxyCode}
 {\itshape initializing robohat}

~\newline
 The parameters consist of 2 arrays of Servo\+Data


\begin{DoxyCode}{0}
\DoxyCodeLine{SERVOBOARD\_1\_DATAS\_ARRAY\ =\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ServoData(1,\ 500,\ 2500,\ 180,\ 0,\ 72.2058435743876,\ -\/22.8429203374794),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ...}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ...}

\end{DoxyCode}
 {\itshape section of the servoboard config array}

\doxysection*{Servo\+Data}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVO\+\_\+\+NR }&\cellcolor{\tableheadbgcolor}\textbf{ servo nr of connected servo   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ SERVO\+\_\+\+NR }&\cellcolor{\tableheadbgcolor}\textbf{ servo nr of connected servo   }\\\cline{1-2}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ MIN\+\_\+\+TIME }&\cellcolor{\tableheadbgcolor}\textbf{ time of minimal angle of the servo in uS (example\+: 500 uS)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ MAX\+\_\+\+TIME }&\cellcolor{\tableheadbgcolor}\textbf{ time of maximal angle of the servo in uS (example\+: 2500 uS)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ RUNNING\+\_\+\+DEGREE }&\cellcolor{\tableheadbgcolor}\textbf{ range of the servo (example\+: 180)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ OFFSET\+\_\+\+DEGREE }&\cellcolor{\tableheadbgcolor}\textbf{ offset of the angle (nearly always\+: 0)   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ FORMULA\+\_\+A }&\cellcolor{\tableheadbgcolor}\textbf{ first parameter of formula, servo measure-\/voltage to angle   }\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ FORMULA\+\_\+B }&\cellcolor{\tableheadbgcolor}\textbf{ second parameter of formula, servo measure-\/voltage to angle   }\\\cline{1-2}
\end{longtabu}




After initialisation the servos position can be altered

\doxysection*{set\+\_\+servos\+\_\+angles}

with the function \textquotesingle{}set\+\_\+servos\+\_\+angles\textquotesingle{} you set all the angles of the 16 servos

/code robohat.\+set\+\_\+servos\+\_\+angles(\mbox{[}angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle, angle\mbox{]}) /endcode {\itshape Setting the servos to an angle} 